<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimating energyscape and biomass consumption with Monte Carlo simulations — mc_simulation • energyscapes</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimating energyscape and biomass consumption with Monte Carlo simulations — mc_simulation"><meta name="description" content="Function to run the Monte Carlo simulation for energyscape and biomass estimations. This functions identifies the prey levels as defined by the prey_taxonomic_level, drop any item for which pW or Energy_content is missing, runs the bio_cons_est function n_sim times for each item, extracts the posterior distributions of each estimated parameter and returns the summarized results for all levels in prey_taxonomic_level."><meta property="og:description" content="Function to run the Monte Carlo simulation for energyscape and biomass estimations. This functions identifies the prey levels as defined by the prey_taxonomic_level, drop any item for which pW or Energy_content is missing, runs the bio_cons_est function n_sim times for each item, extracts the posterior distributions of each estimated parameter and returns the summarized results for all levels in prey_taxonomic_level."><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">energyscapes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/energyscapes.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/energyscape-of-top-predator.html">Energyscape of top predator</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CLambert1/energyscapes/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Estimating energyscape and biomass consumption with Monte Carlo simulations</h1>
      <small class="dont-index">Source: <a href="https://github.com/CLambert1/energyscapes/blob/main/R/mc_simulation.R" class="external-link"><code>R/mc_simulation.R</code></a></small>
      <div class="d-none name"><code>mc_simulation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function to run the Monte Carlo simulation for energyscape and biomass estimations. This functions identifies the prey levels as defined by the prey_taxonomic_level, drop any item for which pW or Energy_content is missing, runs the <code><a href="bio_cons_est.html">bio_cons_est</a></code> function n_sim times for each item, extracts the posterior distributions of each estimated parameter and returns the summarized results for all levels in prey_taxonomic_level.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mc_simulation</span><span class="op">(</span></span>
<span>  <span class="va">predator_name</span>,</span>
<span>  <span class="va">predator_group</span>,</span>
<span>  <span class="va">map_coordinates</span>,</span>
<span>  beta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">prey_taxonomic_level</span>,</span>
<span>  <span class="va">diet</span>,</span>
<span>  assimilation_rate <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  n_days <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">predator_weight</span>,</span>
<span>  <span class="va">abundance_map</span>,</span>
<span>  temperature_map <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nsim <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-predator-name">predator_name<a class="anchor" aria-label="anchor" href="#arg-predator-name"></a></dt>
<dd><p>Character. Name to be used in exported dataframes</p></dd>


<dt id="arg-predator-group">predator_group<a class="anchor" aria-label="anchor" href="#arg-predator-group"></a></dt>
<dd><p>Character. Predator taxonomic group, used to select the allometric equation used to compute the analysis. Can be "Cetacean", "Fish", "Charadriform", "Procellariform", "Loggerhead turtle"</p></dd>


<dt id="arg-map-coordinates">map_coordinates<a class="anchor" aria-label="anchor" href="#arg-map-coordinates"></a></dt>
<dd><p>data.frame containing x and y coordinates of the map</p></dd>


<dt id="arg-beta">beta<a class="anchor" aria-label="anchor" href="#arg-beta"></a></dt>
<dd><p>Vector of life cost parameter, used only for mammals</p></dd>


<dt id="arg-prey-taxonomic-level">prey_taxonomic_level<a class="anchor" aria-label="anchor" href="#arg-prey-taxonomic-level"></a></dt>
<dd><p>Taxonomic level at which the diet is summarize (either "Family", "Taxonomic_group" or "Functional_group", for example), i.e. the column in which prey_group will be subsetted</p></dd>


<dt id="arg-diet">diet<a class="anchor" aria-label="anchor" href="#arg-diet"></a></dt>
<dd><p>Diet table, including the considered predator only. Must include pW (proportion of each item in the diet, as proportion of wet weight), Energy_content of the prey item (in kJ/g) and the column provided in prey_taxonomic_group</p></dd>


<dt id="arg-assimilation-rate">assimilation_rate<a class="anchor" aria-label="anchor" href="#arg-assimilation-rate"></a></dt>
<dd><p>Assimilation rate to be used to estimate the daily ration (default to 0.8)</p></dd>


<dt id="arg-n-days">n_days<a class="anchor" aria-label="anchor" href="#arg-n-days"></a></dt>
<dd><p>Number of days over which estimating biomas consumption (default to 1)</p></dd>


<dt id="arg-predator-weight">predator_weight<a class="anchor" aria-label="anchor" href="#arg-predator-weight"></a></dt>
<dd><p>Vector of body mass distribution for the predator (in kg)</p></dd>


<dt id="arg-abundance-map">abundance_map<a class="anchor" aria-label="anchor" href="#arg-abundance-map"></a></dt>
<dd><p>Abundance map of the predator (must provide columns named mean and sd)</p></dd>


<dt id="arg-temperature-map">temperature_map<a class="anchor" aria-label="anchor" href="#arg-temperature-map"></a></dt>
<dd><p>SST map (only used for fish; must provide columns named mean and sd)</p></dd>


<dt id="arg-nsim">nsim<a class="anchor" aria-label="anchor" href="#arg-nsim"></a></dt>
<dd><p>The number of simulations to run; 1000 by default</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The function returns a list of 8 elements: FMR_map, the map of FMR (kJ/d); Energyscape_map, the energyscape map (kJ/d; FMR * abundance), with the abundance of the species (columns named N_); DailyRation_map, the map of daily ration (kg); DailyRationPropBM_map, the same but as proportion of body mass; DailyRation, the estimated daily ration averaged over the map (as a table; in kg); DailyRationPropBM, the same as proportion of body mass; Conso_map, the map of total consumed biomass (in kg) and Conso, the consumed biomass summed over the map (in kg). When more than one category exists for a prey_taxonomic_level, maps are returned as tables in a long format (directly usable with facetting in ggplot), except for FMR and Energyscape which return the maps estimated with the first category (for these two elements, the result is the same with any prey_group).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># test mc_simulation() with one prey level</span></span></span>
<span class="r-in"><span><span class="va">CALDIO_result</span> <span class="op">&lt;-</span> <span class="fu">mc_simulation</span><span class="op">(</span>predator_name <span class="op">=</span> <span class="st">"CALDIO"</span>, </span></span>
<span class="r-in"><span>                               predator_group <span class="op">=</span> <span class="st">"Procellariform"</span>,</span></span>
<span class="r-in"><span>             map_coordinates <span class="op">=</span> <span class="va">map_coords</span>,</span></span>
<span class="r-in"><span>             prey_taxonomic_level <span class="op">=</span> <span class="st">"Taxonomic_group"</span>, </span></span>
<span class="r-in"><span>             diet <span class="op">=</span> <span class="va">diet</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">Taxonomic_group</span> <span class="op">==</span> <span class="st">"Teleost"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>             assimilation_rate <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>             n_days <span class="op">=</span> <span class="fl">30</span><span class="op">+</span><span class="fl">31</span><span class="op">+</span><span class="fl">31</span>,</span></span>
<span class="r-in"><span>             predator_weight <span class="op">=</span> <span class="va">weight</span>, </span></span>
<span class="r-in"><span>             abundance_map <span class="op">=</span> <span class="va">species_abundance</span>, </span></span>
<span class="r-in"><span>             temperature_map <span class="op">=</span> <span class="va">sst</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># test mc_simulation() with 2 prey levels</span></span></span>
<span class="r-in"><span><span class="va">CALDIO_result</span> <span class="op">&lt;-</span> <span class="fu">mc_simulation</span><span class="op">(</span>predator_name <span class="op">=</span> <span class="st">"CALDIO"</span>, </span></span>
<span class="r-in"><span>                               predator_group <span class="op">=</span> <span class="st">"Procellariform"</span>,</span></span>
<span class="r-in"><span>             map_coordinates <span class="op">=</span> <span class="va">map_coords</span>,</span></span>
<span class="r-in"><span>             prey_taxonomic_level <span class="op">=</span> <span class="st">"Taxonomic_group"</span>, </span></span>
<span class="r-in"><span>             diet <span class="op">=</span> <span class="va">diet</span>, </span></span>
<span class="r-in"><span>             assimilation_rate <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>             n_days <span class="op">=</span> <span class="fl">30</span><span class="op">+</span><span class="fl">31</span><span class="op">+</span><span class="fl">31</span>,</span></span>
<span class="r-in"><span>             predator_weight <span class="op">=</span> <span class="va">weight</span>, </span></span>
<span class="r-in"><span>             abundance_map <span class="op">=</span> <span class="va">species_abundance</span>, </span></span>
<span class="r-in"><span>             temperature_map <span class="op">=</span> <span class="va">sst</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing Teleost for CALDIO</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing Crustacea for CALDIO</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing Cephalopoda for CALDIO</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Wrapping up</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot results</span></span></span>
<span class="r-in"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">CALDIO_result</span><span class="op">$</span><span class="va">Conso</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_pointrange</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Prey_category</span>, x <span class="op">=</span> <span class="va">mean</span>, xmin <span class="op">=</span> <span class="va">L10</span>, xmax <span class="op">=</span> <span class="va">U90</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mc_simulation-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">CALDIO_result</span><span class="op">$</span><span class="va">Energyscape</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">Energyscape_mean</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mc_simulation-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Charlotte Lambert.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

