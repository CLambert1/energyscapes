<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Function to run the Monte Carlo simulation for energyscape and biomass estimations. This functions runs the bio_cons_est function n_sim times, extracts the posterior distributions of each estimated parameter and returns the summarized results."><title>Estimating energyscape and biomass consumption with Monte Carlo simulations — mc_simulation • energyscapes</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimating energyscape and biomass consumption with Monte Carlo simulations — mc_simulation"><meta property="og:description" content="Function to run the Monte Carlo simulation for energyscape and biomass estimations. This functions runs the bio_cons_est function n_sim times, extracts the posterior distributions of each estimated parameter and returns the summarized results."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">energyscapes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/energyscapes.html">Get started</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/energyscape-of-top-predator.html">Energyscape of top predator</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/CLambert1/energyscapes/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Estimating energyscape and biomass consumption with Monte Carlo simulations</h1>
      <small class="dont-index">Source: <a href="https://github.com/CLambert1/energyscapes/blob/HEAD/R/mc_simulation.R" class="external-link"><code>R/mc_simulation.R</code></a></small>
      <div class="d-none name"><code>mc_simulation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function to run the Monte Carlo simulation for energyscape and biomass estimations. This functions runs the <code><a href="bio_cons_est.html">bio_cons_est</a></code> function n_sim times, extracts the posterior distributions of each estimated parameter and returns the summarized results.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mc_simulation</span><span class="op">(</span></span>
<span>  <span class="va">predator_name</span>,</span>
<span>  <span class="va">predator_group</span>,</span>
<span>  <span class="va">map_coordinates</span>,</span>
<span>  <span class="va">beta</span>,</span>
<span>  <span class="va">prey_taxonomic_level</span>,</span>
<span>  <span class="va">diet</span>,</span>
<span>  <span class="va">assimilation_rate</span>,</span>
<span>  <span class="va">n_days</span>,</span>
<span>  <span class="va">predator_weight</span>,</span>
<span>  <span class="va">abundance_map</span>,</span>
<span>  temperature_map <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nsim <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>predator_name</dt>
<dd><p>Character. Name to be used in exported dataframes</p></dd>


<dt>predator_group</dt>
<dd><p>Character. Predator taxonomic group, used to select the allometric equation used to compute the analysis. Can be "Cetacean", "Fish", "Charadriform", "Procellariform", "Loggerhead turtle"</p></dd>


<dt>map_coordinates</dt>
<dd><p>data.frame containing x and y coordinates of the map</p></dd>


<dt>beta</dt>
<dd><p>Vector of life cost parameter, used only for mammals</p></dd>


<dt>prey_taxonomic_level</dt>
<dd><p>Taxonomic level at which the diet is summarize (either "Family", "Taxonomic_group" or "Functional_group", for example), i.e. the column in which prey_group will be subsetted</p></dd>


<dt>diet</dt>
<dd><p>Diet table, including the considered predator only. Must include pW (proportion of each item in the diet, as proportion of wet weight), Energy_content of the prey item (in kJ/g) and the column provided in prey_taxonomic_group</p></dd>


<dt>assimilation_rate</dt>
<dd><p>Assimilation rate to be used to estimate the daily ration (default to 0.8)</p></dd>


<dt>n_days</dt>
<dd><p>Number of days over which estimating biomas consumption (default to 1)</p></dd>


<dt>predator_weight</dt>
<dd><p>Vector of body mass distribution for the predator (in kg)</p></dd>


<dt>abundance_map</dt>
<dd><p>Abundance map of the predator (must provide columns named mean and sd)</p></dd>


<dt>temperature_map</dt>
<dd><p>SST map (only used for fish; must provide columns named mean and sd)</p></dd>


<dt>nsim</dt>
<dd><p>The number of simulations to run; 1000 by default</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The function returns a list of 8 elements: FMR_map, the map of FMR (kJ/d); Energyscape_map, the energyscape map (kJ/d; FMR * abundance); DailyRation_map, the map of daily ration (kg); DailyRationPropBM_map, the same but as proportion of body mass; DailyRation, the estimated daily ration averaged over the map (as a table; in kg); DailyRationPropBM, the same as proportion of body mass; Conso_map, the map of total consumed biomass (in kg) and Conso, the consumed biomass summed over the map (in kg). When more than one category exists for a prey_taxonomic_level, maps are returned as tables in a long format (directly usable with facetting in ggplot), except for FMR and Energyscape which return the maps estimated with the first category (for these two elements, the result is the same with any prey_group).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># test mc_simulation() with one prey level</span></span></span>
<span class="r-in"><span><span class="va">TURTRU_result</span> <span class="op">&lt;-</span> <span class="fu">mc_simulation</span><span class="op">(</span>predator_name <span class="op">=</span> <span class="st">"TURTRU"</span>, </span></span>
<span class="r-in"><span>                               predator_group <span class="op">=</span> <span class="st">"Cetacean"</span>,</span></span>
<span class="r-in"><span>             map_coordinates <span class="op">=</span> <span class="va">map_coords</span>,</span></span>
<span class="r-in"><span>             prey_taxonomic_level <span class="op">=</span> <span class="st">"Taxonomic_group"</span>, </span></span>
<span class="r-in"><span>             diet <span class="op">=</span> <span class="va">diet</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">Taxonomic_group</span> <span class="op">==</span> <span class="st">"Cephalopoda"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>             assimilation_rate <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>             n_days <span class="op">=</span> <span class="fl">30</span><span class="op">+</span><span class="fl">31</span><span class="op">+</span><span class="fl">31</span>,</span></span>
<span class="r-in"><span>             predator_weight <span class="op">=</span> <span class="va">weight</span>, </span></span>
<span class="r-in"><span>             abundance_map <span class="op">=</span> <span class="va">species_abundance</span>, </span></span>
<span class="r-in"><span>             temperature_map <span class="op">=</span> <span class="va">sst</span>, <span class="co"># not used for cetaceans and seabirds</span></span></span>
<span class="r-in"><span>             beta <span class="op">=</span> <span class="va">beta</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># test mc_simulation() with 2 prey levels</span></span></span>
<span class="r-in"><span><span class="va">TURTRU_result</span> <span class="op">&lt;-</span> <span class="fu">mc_simulation</span><span class="op">(</span>predator_name <span class="op">=</span> <span class="st">"TURTRU"</span>, </span></span>
<span class="r-in"><span>                               predator_group <span class="op">=</span> <span class="st">"Cetacean"</span>,</span></span>
<span class="r-in"><span>             map_coordinates <span class="op">=</span> <span class="va">map_coords</span>,</span></span>
<span class="r-in"><span>             prey_taxonomic_level <span class="op">=</span> <span class="st">"Taxonomic_group"</span>, </span></span>
<span class="r-in"><span>             diet <span class="op">=</span> <span class="va">diet</span>, </span></span>
<span class="r-in"><span>             assimilation_rate <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>             n_days <span class="op">=</span> <span class="fl">30</span><span class="op">+</span><span class="fl">31</span><span class="op">+</span><span class="fl">31</span>,</span></span>
<span class="r-in"><span>             predator_weight <span class="op">=</span> <span class="va">weight</span>, </span></span>
<span class="r-in"><span>             abundance_map <span class="op">=</span> <span class="va">species_abundance</span>, </span></span>
<span class="r-in"><span>             temperature_map <span class="op">=</span> <span class="va">sst</span>, <span class="co"># not used for cetaceans and seabirds</span></span></span>
<span class="r-in"><span>             beta <span class="op">=</span> <span class="va">beta</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing Teleost for TURTRU</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing Cephalopoda for TURTRU</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Wrapping up</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot results</span></span></span>
<span class="r-in"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">TURTRU_result</span><span class="op">$</span><span class="va">Conso</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_pointrange</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Prey_category</span>, x <span class="op">=</span> <span class="va">mean</span>, xmin <span class="op">=</span> <span class="va">L10</span>, xmax <span class="op">=</span> <span class="va">U90</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mc_simulation-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">TURTRU_result</span><span class="op">$</span><span class="va">Energyscape</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">Energyscape_mean</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mc_simulation-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Charlotte Lambert.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

